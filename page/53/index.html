<!DOCTYPE html>



  


<html class="theme-next muse use-motion" lang="en">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">
<meta name="baidu-site-verification" content="codeva-Ss7c9LFzfb" />
<meta name="bytedance-verification-code" content="GHbi5zMz8c6TSVpY9rLD" />







<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="Hexo, NexT" />










<meta name="description" content="some program,some life,some code, and some linux">
<meta property="og:type" content="website">
<meta property="og:title" content="Resive world">
<meta property="og:url" content="https://www.resonanat.com/page/53/index.html">
<meta property="og:site_name" content="Resive world">
<meta property="og:description" content="some program,some life,some code, and some linux">
<meta property="og:locale" content="en_US">
<meta property="article:author" content="Companyd">
<meta property="article:tag" content="ubuntu linux java elasitesearch">
<meta name="twitter:card" content="summary">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '',
    scheme: 'Muse',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: 'Author'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="https://www.resonanat.com/page/53/"/>



<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-4636539228226058"
     crossorigin="anonymous"></script>
<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-67H9TCZZ7N"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-67H9TCZZ7N');
</script>


  <title>Resive world - Come world to Record life</title>
  








<meta name="generator" content="Hexo 7.1.0"></head>

<body itemscope itemtype="http://schema.org/WebPage" lang="en">

  
  
    
  

  <div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Resive world</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <h1 class="site-subtitle" itemprop="description">Come world to Record life</h1>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            Home
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            Tags
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            Categories
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            Archives
          </a>
        </li>
      
        
        <li class="menu-item menu-item-sitemap">
          <a href="/sitemap.xml" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-sitemap"></i> <br />
            
            Sitemap
          </a>
        </li>
      

      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br />
            
            Search
          </a>
        </li>
      
    </ul>
  

  
    <div class="site-search">
      
  <div class="popup search-popup local-search-popup">
  <div class="local-search-header clearfix">
    <span class="search-icon">
      <i class="fa fa-search"></i>
    </span>
    <span class="popup-btn-close">
      <i class="fa fa-times-circle"></i>
    </span>
    <div class="local-search-input-wrapper">
      <input autocomplete="off"
             placeholder="Searching..." spellcheck="false"
             type="text" id="local-search-input">
    </div>
  </div>
  <div id="local-search-result"></div>
</div>



    </div>
  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://www.resonanat.com/2015/11/06/%E5%B7%A6%E5%81%8F%E6%A0%91%E7%AE%80%E8%BF%B0/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Resive world">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2015/11/06/%E5%B7%A6%E5%81%8F%E6%A0%91%E7%AE%80%E8%BF%B0/" itemprop="url">左偏树简述</a></h2>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2015-11-06T15:21:05+00:00">
                2015-11-06
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Algorithm/" itemprop="url" rel="index">
                    <span itemprop="name">Algorithm</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="简述"><a href="#简述" class="headerlink" title="简述"></a>简述</h2><p>左偏树与二叉堆一样，是一种优先队列的实现。但是与二叉堆不一样，他不是一种完全二叉树，而是一种不平衡二叉树，这样做的目的是为了实现一个重要的性质–合并。通常的二叉堆并不能方便的实现两个堆之间的合并，而左偏树，却恰恰适合解决这样的问题。</p>
<h2 id="实现功能"><a href="#实现功能" class="headerlink" title="实现功能"></a>实现功能</h2><p>实现一个最小优先队列，是的插入、删除、合并等操作均在$O(logN)$的时间复杂度内完成。</p>
<h2 id="实现思路"><a href="#实现思路" class="headerlink" title="实现思路"></a>实现思路</h2><p>左偏树定义了一种节点叫“外节点”，即这个节点的左子树或者右子树为空。并且定义了一个性质叫“距离”，就是这个节点到他子孙中最近的外节点的距离，如果本身就是外节点，那么距离就是0，为了方便，我们把空节点的距离定义为-1。一个合法的左偏树需要满足对于任意节点，他的左子孙的距离不小于右子孙的距离，即”左偏性质“。当然，他还得有堆性质，即父亲节点的值不能大于子孙节点的值，这样才能保证优先队列的性质。同时，他还具有递归的性质，即左偏树的任意一棵子树也是左偏树。</p>
<p>为什么这样的结构就能实现快速合并呢？这就牵涉到我们”合并“的方法了。</p>
<p>当我们要合并两个左偏树的时候，我们将堆顶元素较大的那棵树与另外一棵树的右子树合并得到新树（维护堆性质），并将新树作为之前那棵树的右子树得到，如果这时右子树的距离大于左子树的距离，那么就要交换这两棵子树并将堆顶的距离重新设置（维护左偏的性质）。这是一个递归的过程，递归的终点就是合并到空节点。</p>
<p>由左偏树的性质可以知道，他的右子树的距离不会大于$O(logN)$，所以合并的复杂度也不会大于$O(logN)$。这就满足了快速合并的要求。</p>
<h2 id="基本模版"><a href="#基本模版" class="headerlink" title="基本模版"></a>基本模版</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MAXN = <span class="number">100000</span>;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">LeftlistTree</span>&#123;</span><br><span class="line">	<span class="type">int</span>	n,		  <span class="comment">//保存节点的个数</span></span><br><span class="line">		v[MAXN],  <span class="comment">//保存节点的值</span></span><br><span class="line">		l[MAXN],  <span class="comment">//保存左儿子的位置</span></span><br><span class="line">		r[MAXN],  <span class="comment">//保存右儿子的位置</span></span><br><span class="line">		d[MAXN];  <span class="comment">//保存节点的距离</span></span><br><span class="line">	<span class="function"><span class="type">int</span> <span class="title">merge</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> y)</span></span>;<span class="comment">//将节点x和y的树合并</span></span><br><span class="line">	<span class="function"><span class="type">int</span> <span class="title">init</span><span class="params">(<span class="type">int</span> x)</span></span>;        <span class="comment">//新建一个单节点的子树，并返回他的堆顶元素的位置</span></span><br><span class="line">	<span class="function"><span class="type">int</span> <span class="title">insert</span><span class="params">(<span class="type">int</span>  x, <span class="type">int</span> value)</span></span>;<span class="comment">//将权值为value的节点加入编号为x的左偏树中，返回新的堆顶编号</span></span><br><span class="line">	<span class="function"><span class="type">int</span> <span class="title">top</span><span class="params">(<span class="type">int</span> x)</span></span>;			<span class="comment">//获得堆顶元素，返回权值</span></span><br><span class="line">	<span class="function"><span class="type">int</span> <span class="title">pop</span><span class="params">(<span class="type">int</span> x)</span></span>;         <span class="comment">//将编号为x的树的堆顶删除</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">LeftlistTree::merge</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> y)</span></span>&#123;</span><br><span class="line">	<span class="keyword">if</span> (!x)</span><br><span class="line">		<span class="keyword">return</span> y;</span><br><span class="line">	<span class="keyword">if</span> (!y)</span><br><span class="line">		<span class="keyword">return</span> x;</span><br><span class="line">	<span class="keyword">if</span> (v[x] &lt; v[y])</span><br><span class="line">		<span class="built_in">swap</span>(x, y);</span><br><span class="line">	r[x] = <span class="built_in">merge</span>(r[x], y);</span><br><span class="line">	<span class="keyword">if</span> (d[l[x]] &lt; d[r[x]])</span><br><span class="line">		<span class="built_in">swap</span>(l[x], r[x]);</span><br><span class="line">	d[x] = d[r[x]] + <span class="number">1</span>;</span><br><span class="line">	<span class="keyword">return</span> x;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">LeftlistTree::init</span><span class="params">(<span class="type">int</span> x)</span></span>&#123;</span><br><span class="line">	n++;</span><br><span class="line">	v[n] = x;</span><br><span class="line">	l[n] = r[n] = d[n] = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">return</span> n;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span>  <span class="title">LeftlistTree::insert</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> value)</span></span>&#123;</span><br><span class="line">	<span class="keyword">return</span> <span class="built_in">merge</span>(x, <span class="built_in">init</span>(value));</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">LeftlistTree::top</span><span class="params">(<span class="type">int</span> x)</span></span>&#123;</span><br><span class="line">	<span class="keyword">return</span> v[x];</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">LeftlistTree::pop</span><span class="params">(<span class="type">int</span> x)</span></span>&#123;</span><br><span class="line">	<span class="keyword">return</span> <span class="built_in">merge</span>(l[x], r[x]);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://www.resonanat.com/2015/11/06/%E4%BA%8C%E5%8F%89%E5%A0%86%E7%AE%80%E8%BF%B0/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Resive world">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2015/11/06/%E4%BA%8C%E5%8F%89%E5%A0%86%E7%AE%80%E8%BF%B0/" itemprop="url">二叉堆简述</a></h2>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2015-11-06T11:19:54+00:00">
                2015-11-06
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Algorithm/" itemprop="url" rel="index">
                    <span itemprop="name">Algorithm</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="简述"><a href="#简述" class="headerlink" title="简述"></a>简述</h2><p>对于堆，我个人的理解就是一种优先队列，从队列中取元素的时候总是取出最大（或最小）的元素。二叉堆是一种堆的一种实现形式，是一棵完全二叉树。对于二叉堆，我们显然可以分成两类：大根堆和小根堆，表示他每次取出的是最大元素还是最小元素。而大根堆一定是满足这样的一个性质，即：对于任意一个节点，他一定不大于他的父亲，而且不小于他的两个儿子。小根堆反之。</p>
<h2 id="实现功能"><a href="#实现功能" class="headerlink" title="实现功能"></a>实现功能</h2><p>以$O(n)$的时间建树，并以$O(logn)$的复杂度实现插入、寻找最小（或最大）值，修改元素，删除元素。</p>
<h2 id="实现思路（小根堆）"><a href="#实现思路（小根堆）" class="headerlink" title="实现思路（小根堆）"></a>实现思路（小根堆）</h2><p>我们用一个数组来储存数据，下标从1开始，对于第$i$个元素，他的左儿子为$i<em>2$，他的右儿子为$i</em>2+1$，当然对于非根节点，他的父亲就是$i&#x2F;2$。在这里，这个数组用$heap[]$表示。</p>
<p>同时，我们用数组$id[i]$数组来表示第(i)个元素是第几个插入的，用$pos[i]$来表示第$i$个元素是第几个插入的（很明显有$id[pos[i]]&#x3D;i$）。当然，根据实际情况，这两个东西可以不要。</p>
<p>这里要用到的最重要的两个函数是$up(i)$和$down(i)$函数， $up(i)$函数是将第$i$个元素上移，如果他比他的父亲大，就和他的父亲交换位置，即维护他比他父亲小的性质。$down(i)$函数类似，只是比较的是两个儿子中较小的那个。</p>
<p>接下来是算法的核心：</p>
<ul>
<li>当加入一个元素时，我们把他加入到堆的底部，即heap数组的末尾，然后调用$up(i)$函数将其上移到合适位置。</li>
<li>当修改一个元素时，只要直接修改，然后分别调用$down(i)$函数和$up(i)$函数找到他适合的位置。</li>
<li>当删除堆顶元素的时候，我们只要把他和最后一个元素交换位置（这样只需要将数组大小减一就可以删掉他），然后用$down(i)$函数将堆顶元素下移到合适位置。</li>
<li>当删除任意元素时，只需要把他赋值为负无穷，然后上浮到堆顶，再利用删除堆顶元素的方法删除他。</li>
</ul>
<h2 id="基本模版"><a href="#基本模版" class="headerlink" title="基本模版"></a>基本模版</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MAXSIZE = <span class="number">100000</span>;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Heap</span>&#123;</span><br><span class="line">	<span class="type">int</span> heap[MAXSIZE];<span class="comment">//记录堆的元素,下标从1开始</span></span><br><span class="line">	<span class="type">int</span> n;<span class="comment">//堆中元素的个数</span></span><br><span class="line">	<span class="type">int</span> counter;<span class="comment">//加入到堆中的元素的个数（考虑到被删除的元素）</span></span><br><span class="line">	<span class="type">int</span> id[MAXSIZE];<span class="comment">//第i个元素是第几个加入的</span></span><br><span class="line">	<span class="type">int</span> pos[MAXSIZE];<span class="comment">//第i个加入的元素的位置</span></span><br><span class="line">	<span class="built_in">Heap</span>();<span class="comment">//一个空的Heap</span></span><br><span class="line">	<span class="built_in">Heap</span>(<span class="type">int</span> *, <span class="type">int</span> n);<span class="comment">//用一个数组初始化Heap,数组下标从0开始</span></span><br><span class="line">	<span class="function"><span class="type">void</span> <span class="title">push</span><span class="params">(<span class="type">int</span> v)</span></span>;<span class="comment">//添加元素v</span></span><br><span class="line">	<span class="function"><span class="type">void</span> <span class="title">change</span><span class="params">(<span class="type">int</span> i, <span class="type">int</span> value)</span></span>;<span class="comment">//把第i个加进去的元素修改为value</span></span><br><span class="line">	<span class="function"><span class="type">void</span> <span class="title">pop</span><span class="params">()</span></span>;<span class="comment">//删掉堆顶</span></span><br><span class="line">	<span class="function"><span class="type">void</span> <span class="title">erase</span><span class="params">(<span class="type">int</span> i)</span></span>;<span class="comment">//删除第i个加进去的元素</span></span><br><span class="line">	<span class="function"><span class="type">void</span> <span class="title">up</span><span class="params">(<span class="type">int</span> i)</span></span>;<span class="comment">//将数组中第i个元素上移</span></span><br><span class="line">	<span class="function"><span class="type">void</span> <span class="title">down</span><span class="params">(<span class="type">int</span> i)</span></span>;<span class="comment">//将数组中第i个元素下移</span></span><br><span class="line">	<span class="function"><span class="type">int</span> <span class="title">top</span><span class="params">()</span></span>;<span class="comment">//返回堆顶元素</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">Heap::<span class="built_in">Heap</span>()&#123;</span><br><span class="line">	n = counter = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Heap::<span class="built_in">Heap</span>(<span class="type">int</span> a[], <span class="type">int</span> n)&#123;</span><br><span class="line">	n = counter = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; i++)&#123;</span><br><span class="line">		heap[++n] = a[i];</span><br><span class="line">		id[n] = pos[n] = n;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">for</span> (<span class="type">int</span> i = n / <span class="number">2</span>; i &gt;= <span class="number">1</span>; i--)&#123;</span><br><span class="line">		<span class="built_in">down</span>(i);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">Heap::up</span><span class="params">(<span class="type">int</span> i)</span></span>&#123;</span><br><span class="line">	<span class="type">int</span> x = heap[i], y = id[i];</span><br><span class="line">	<span class="keyword">for</span> (<span class="type">int</span> j = i / <span class="number">2</span>; j &gt;= <span class="number">1</span>; j /= <span class="number">2</span>)&#123;</span><br><span class="line">		<span class="keyword">if</span> (heap[j]&gt;x)&#123;</span><br><span class="line">			heap[i] = heap[j];</span><br><span class="line">			id[i] = id[j];</span><br><span class="line">			pos[id[i]] = i;</span><br><span class="line">			i = j;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">else</span>&#123;</span><br><span class="line">			<span class="keyword">break</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		heap[i] = x;</span><br><span class="line">		id[i] = y;</span><br><span class="line">		pos[y] = i;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">Heap::down</span><span class="params">(<span class="type">int</span> i)</span></span>&#123;</span><br><span class="line">	<span class="type">int</span> x = heap[i], y = id[i];</span><br><span class="line">	<span class="keyword">for</span> (<span class="type">int</span> j = i * <span class="number">2</span>; j &lt;= n; j *= <span class="number">2</span>)&#123;</span><br><span class="line">		<span class="keyword">if</span> (j&lt;n&amp;&amp;heap[j]&gt;heap[j + <span class="number">1</span>])</span><br><span class="line">			j++;</span><br><span class="line">		<span class="keyword">if</span> (heap[j] &lt; x)&#123;</span><br><span class="line">			heap[i] = heap[j];</span><br><span class="line">			id[i] = id[j];</span><br><span class="line">			pos[id[i]] = i;</span><br><span class="line">			i = j;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">else</span>&#123;</span><br><span class="line">			<span class="keyword">break</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		heap[i] = x;</span><br><span class="line">		id[i] = y;</span><br><span class="line">		pos[y] = i;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">Heap::push</span><span class="params">(<span class="type">int</span> v)</span></span>&#123;</span><br><span class="line">	heap[++n] = v;</span><br><span class="line">	id[n] = ++counter;</span><br><span class="line">	pos[counter] = n;</span><br><span class="line">	<span class="built_in">up</span>(n);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">Heap::top</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="keyword">return</span> heap[<span class="number">1</span>];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">Heap::pop</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="built_in">swap</span>(heap[<span class="number">1</span>], heap[n]);</span><br><span class="line">	<span class="built_in">swap</span>(id[<span class="number">1</span>], id[n--]);</span><br><span class="line">	pos[id[<span class="number">1</span>]] = <span class="number">1</span>;</span><br><span class="line">	<span class="built_in">down</span>(<span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">Heap::change</span><span class="params">(<span class="type">int</span> i, <span class="type">int</span> value)</span></span>&#123;</span><br><span class="line">	heap[pos[i]] = value;</span><br><span class="line">	<span class="built_in">down</span>(pos[i]);</span><br><span class="line">	<span class="built_in">up</span>(pos[i]);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">Heap::erase</span><span class="params">(<span class="type">int</span> i)</span></span>&#123;</span><br><span class="line">	heap[pos[i]] = heap[<span class="number">1</span>] - <span class="number">1</span>;</span><br><span class="line">	<span class="built_in">up</span>(pos[i]);</span><br><span class="line">	<span class="built_in">pop</span>();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://www.resonanat.com/2015/11/05/%E5%88%A9%E7%94%A8BigDump%E5%90%91mysql%E5%AF%BC%E5%85%A5%E8%B6%85%E5%A4%A7%E6%95%B0%E6%8D%AE/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Resive world">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2015/11/05/%E5%88%A9%E7%94%A8BigDump%E5%90%91mysql%E5%AF%BC%E5%85%A5%E8%B6%85%E5%A4%A7%E6%95%B0%E6%8D%AE/" itemprop="url">利用BigDump向mysql导入超大数据</a></h2>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2015-11-05T09:16:00+00:00">
                2015-11-05
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Database/" itemprop="url" rel="index">
                    <span itemprop="name">Database</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>本来就只想轻轻松松把服务器的mysql数据导入到本地的mysql里的，结果发现这个问题还是一个坑。phpmyadmin里把导入数据的大小限定为了2M，然而我的数据有4M。想分表导入结果发现有一个表的大小还是超过了传输上限。百度了以下据说可以通过修改php和phpmyadmin的配置文件来略微的扩容，结果配置了半天头都大了而且还没有用，后来据说可以通过配置主从服务器来传输，但是那个从服务器的配置始终弄不对（其实是对这种设置的用途理解不够）。最后终于还是用了第三方的脚本，这也是无奈之举，不过用了才知道还是很方便的。</p>
<p>BigDump.php脚本源码在官网下载<a target="_blank" rel="noopener" href="http://www.ozerov.de/bigdump/">Bigdump</a>。（其实只有1000多行，本来打算直接贴过来的，但是发现这里的文本编辑器会对一些字符进行转义，导致保存下来的文件不正确，后来有一次用的时候才发现问题，于是直接贴一下官网地址，也方便以后查询更新。）</p>
<p>使用之前需要稍微进行一下配置（这是显然的，要不然怎么知道写到哪个数据库里），在文件中的40行左右找到以下几项：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$db_server   = &#x27;&#x27;;</span><br><span class="line">$db_name     = &#x27;&#x27;;</span><br><span class="line">$db_username = &#x27;&#x27;;</span><br><span class="line">$db_password = &#x27;&#x27;;</span><br></pre></td></tr></table></figure>
<p>分别填入ip（本机的当然写localhost），数据库的库名，登陆的用户名，密码。</p>
<p>这样就算配置完成了，接下来只要把这个文件放在站点的某个位置里（为了能通过浏览器访问到），再把需要导入的.sql文件放在同文件夹下即可，通过浏览器访问这个文件，找到需要导入的数据库，点击根据提示操作就行了。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://www.resonanat.com/2015/11/04/php5-mysql-phpmyadmin%E5%AE%89%E8%A3%85%E5%92%8C%E9%85%8D%E7%BD%AE/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Resive world">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2015/11/04/php5-mysql-phpmyadmin%E5%AE%89%E8%A3%85%E5%92%8C%E9%85%8D%E7%BD%AE/" itemprop="url">php5-mysql-phpmyadmin安装和配置</a></h2>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2015-11-04T11:49:52+00:00">
                2015-11-04
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Database/" itemprop="url" rel="index">
                    <span itemprop="name">Database</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>php5和mysql的安装比较无脑，也基本无需配置，安装命令：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">myths@myths-X450LD:~$ sudo apt-get install php5</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">myths@myths-X450LD:~$ sudo apt-get install mysql-server</span><br></pre></td></tr></table></figure>
<p>唯一要注意的是mysql安装的时候需要输入密码，这就是数据库的密码，以后要用到的，需要记住。</p>
<p>接下来安装phpmyadmin，外行乍一看觉得这是个管理php的东西，其实php要个啥子管理啊，这个是用php写的用来管理mysql的小软件，通过这个可以方便的管理数据库。</p>
<p>安装命令：<code>myths@myths-X450LD:~$ sudo apt-get install phpmyadmin</code></p>
<p>当然安装中会提示输一些东西，就是一种图形界面的配置，方便人用的。这当中需要输入之前安装mysql时的密码，照着弄就对了。</p>
<p>安装结束后，phpmyadmin被默认安装到了&#x2F;usr&#x2F;share&#x2F;phpmyadmin中，软件的入口当然就是index.php了。不过为了访问的方便，还是加一个链接到我们的目录中：<br><code>myths@myths-X450LD:sudo ln -s /usr/share/phpmyadmin /var/www/html/</code><br>这样就可以通过本地访问该网页的形式打开这个小软件了。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://www.resonanat.com/2015/11/04/apache2%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%9A%84%E6%90%AD%E5%BB%BA%E4%B8%8E%E9%85%8D%E7%BD%AE/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Resive world">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2015/11/04/apache2%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%9A%84%E6%90%AD%E5%BB%BA%E4%B8%8E%E9%85%8D%E7%BD%AE/" itemprop="url">apache2服务器的搭建与配置</a></h2>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2015-11-04T10:31:21+00:00">
                2015-11-04
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Apache/" itemprop="url" rel="index">
                    <span itemprop="name">Apache</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>搭建apache2其实并不难，只是网上的资料有很多都过时了，之前被误导过好几次，走了很多弯路。趁着这次在本地搭建网站的时机重新捋一下思路，也方便以后有需求的时候查阅。</p>
<p>首先当然是下载包包：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">myths@myths-X450LD:~$ sudo apt-get install apache2</span><br></pre></td></tr></table></figure>
<p>装完后就可以用了，在地址栏输入本地回送地址127.0.0.1或者localhost就可以进入到默认的界面了。</p>
<p>默认的界面当然就是apache2的说明界面了。其实很多情况下并不需要在网上寻找帮助文档，几乎所有的软件都会自带使用说明，只是略长，我们一般都懒得看。但是其实很多重要的东西就在这当中，比如apache2的默认界面里：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">Ubuntu Logo Apache2 Ubuntu Default Page</span><br><span class="line">It works!</span><br><span class="line">This is the default welcome page used to test the correct operation of the Apache2 server after installation on Ubuntu systems. It is based on the equivalent page on Debian, from which the Ubuntu Apache packaging is derived. If you can read this page, it means that the Apache HTTP server installed at this site is working properly. You should replace this file (located at /var/www/html/index.html) before continuing to operate your HTTP server.</span><br><span class="line">If you are a normal user of this web site and don&#x27;t know what this page is about, this probably means that the site is currently unavailable due to maintenance. If the problem persists, please contact the site&#x27;s administrator.</span><br><span class="line">Configuration Overview</span><br><span class="line">Ubuntu&#x27;s Apache2 default configuration is different from the upstream default configuration, and split into several files optimized for interaction with Ubuntu tools. The configuration system is fully documented in /usr/share/doc/apache2/README.Debian.gz. Refer to this for the full documentation. Documentation for the web server itself can be found by accessing the manual if the apache2-doc package was installed on this server.</span><br><span class="line">The configuration layout for an Apache2 web server installation on Ubuntu systems is as follows:</span><br><span class="line">/etc/apache2/</span><br><span class="line">|-- apache2.conf</span><br><span class="line">|       `--  ports.conf</span><br><span class="line">|-- mods-enabled</span><br><span class="line">|       |-- *.load</span><br><span class="line">|       `-- *.conf</span><br><span class="line">|-- conf-enabled</span><br><span class="line">|       `-- *.conf</span><br><span class="line">|-- sites-enabled</span><br><span class="line">|       `-- *.conf</span><br><span class="line"></span><br><span class="line">apache2.conf is the main configuration file. It puts the pieces together by including all remaining configuration files when starting up the web server.</span><br><span class="line">ports.conf is always included from the main configuration file. It is used to determine the listening ports for incoming connections, and this file can be customized anytime.</span><br><span class="line">Configuration files in the mods-enabled/, conf-enabled/ and sites-enabled/ directories contain particular configuration snippets which manage modules, global configuration fragments, or virtual host configurations, respectively.</span><br><span class="line">They are activated by symlinking available configuration files from their respective *-available/ counterparts. These should be managed by using our helpers a2enmod, a2dismod, a2ensite, a2dissite, and a2enconf, a2disconf . See their respective man pages for detailed information.</span><br><span class="line">The binary is called apache2\. Due to the use of environment variables, in the default configuration, apache2 needs to be started/stopped with /etc/init.d/apache2 or apache2ctl. Calling /usr/bin/apache2 directly will not work with the default configuration.</span><br><span class="line">Document Roots</span><br><span class="line">By default, Ubuntu does not allow access through the web browser to any file apart of those located in /var/www, public_html directories (when enabled) and /usr/share (for web applications). If your site is using a web document root located elsewhere (such as in /srv) you may need to whitelist your document root directory in /etc/apache2/apache2.conf.</span><br><span class="line">The default Ubuntu document root is /var/www/html. You can make your own virtual hosts under /var/www. This is different to previous releases which provides better security out of the box.</span><br><span class="line">Reporting Problems</span><br><span class="line">Please use the ubuntu-bug tool to report bugs in the Apache2 package with Ubuntu. However, check existing bug reports before reporting a new bug.</span><br><span class="line">Please report bugs specific to modules (such as PHP and others) to respective packages, not to the web server itself.</span><br><span class="line">Valid XHTML 1.0 Transitional</span><br></pre></td></tr></table></figure>
<p>仅仅从这个文件中，我们就可以至少得到以下的重要信息：</p>
<ol>
<li>当访问本机的时候，默认进入的页面是&#x2F;var&#x2F;www&#x2F;html&#x2F;index.html。</li>
<li>配置系统的说明在&#x2F;usr&#x2F;share&#x2F;doc&#x2F;apache2&#x2F;README.Debian.gz中。</li>
<li>完整使用手册可以通过安装apache2-doc 进行下载。</li>
<li>主配置文件为&#x2F;etc&#x2F;apache2&#x2F;apache2.conf。</li>
<li>启动和关闭apache2服务可以通过执行命令&#x2F;etc&#x2F;init.d&#x2F;apache2 start（stop &#x2F; restart）当然也可以是 service apache2 start (stop &#x2F; restart)。这里一定要注意记得！记得！加root权限！这里不加root权限并没有明显的提示（好坑），当遇到问题的时候很难让人想到是这里出的错，所以一定要记得！记得！加root权限！</li>
<li>默认情况下apache2拒绝访问除&#x2F;var&#x2F;www 和&#x2F;usr&#x2F;share文件夹外的其他文件，这种权限是通过apache2.conf文件来控制的.</li>
</ol>
<p>默认的apache2.conf为：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br></pre></td><td class="code"><pre><span class="line"># This is the main Apache server configuration file.  It contains the</span><br><span class="line"># configuration directives that give the server its instructions.</span><br><span class="line"># See http://httpd.apache.org/docs/2.4/ for detailed information about</span><br><span class="line"># the directives and /usr/share/doc/apache2/README.Debian about Debian specific</span><br><span class="line"># hints.</span><br><span class="line">#</span><br><span class="line">#</span><br><span class="line"># Summary of how the Apache 2 configuration works in Debian:</span><br><span class="line"># The Apache 2 web server configuration in Debian is quite different to</span><br><span class="line"># upstream&#x27;s suggested way to configure the web server. This is because Debian&#x27;s</span><br><span class="line"># default Apache2 installation attempts to make adding and removing modules,</span><br><span class="line"># virtual hosts, and extra configuration directives as flexible as possible, in</span><br><span class="line"># order to make automating the changes and administering the server as easy as</span><br><span class="line"># possible.</span><br><span class="line"></span><br><span class="line"># It is split into several files forming the configuration hierarchy outlined</span><br><span class="line"># below, all located in the /etc/apache2/ directory:</span><br><span class="line">#</span><br><span class="line">#	/etc/apache2/</span><br><span class="line">#	|-- apache2.conf</span><br><span class="line">#	|	`--  ports.conf</span><br><span class="line">#	|-- mods-enabled</span><br><span class="line">#	|	|-- *.load</span><br><span class="line">#	|	`-- *.conf</span><br><span class="line">#	|-- conf-enabled</span><br><span class="line">#	|	`-- *.conf</span><br><span class="line"># 	`-- sites-enabled</span><br><span class="line">#	 	`-- *.conf</span><br><span class="line">#</span><br><span class="line">#</span><br><span class="line"># * apache2.conf is the main configuration file (this file). It puts the pieces</span><br><span class="line">#   together by including all remaining configuration files when starting up the</span><br><span class="line">#   web server.</span><br><span class="line">#</span><br><span class="line"># * ports.conf is always included from the main configuration file. It is</span><br><span class="line">#   supposed to determine listening ports for incoming connections which can be</span><br><span class="line">#   customized anytime.</span><br><span class="line">#</span><br><span class="line"># * Configuration files in the mods-enabled/, conf-enabled/ and sites-enabled/</span><br><span class="line">#   directories contain particular configuration snippets which manage modules,</span><br><span class="line">#   global configuration fragments, or virtual host configurations,</span><br><span class="line">#   respectively.</span><br><span class="line">#</span><br><span class="line">#   They are activated by symlinking available configuration files from their</span><br><span class="line">#   respective *-available/ counterparts. These should be managed by using our</span><br><span class="line">#   helpers a2enmod/a2dismod, a2ensite/a2dissite and a2enconf/a2disconf. See</span><br><span class="line">#   their respective man pages for detailed information.</span><br><span class="line">#</span><br><span class="line"># * The binary is called apache2\. Due to the use of environment variables, in</span><br><span class="line">#   the default configuration, apache2 needs to be started/stopped with</span><br><span class="line">#   /etc/init.d/apache2 or apache2ctl. Calling /usr/bin/apache2 directly will not</span><br><span class="line">#   work with the default configuration.</span><br><span class="line"></span><br><span class="line"># Global configuration</span><br><span class="line">#</span><br><span class="line"></span><br><span class="line">#</span><br><span class="line"># ServerRoot: The top of the directory tree under which the server&#x27;s</span><br><span class="line"># configuration, error, and log files are kept.</span><br><span class="line">#</span><br><span class="line"># NOTE!  If you intend to place this on an NFS (or otherwise network)</span><br><span class="line"># mounted filesystem then please read the Mutex documentation (available</span><br><span class="line"># at &lt;URL:http://httpd.apache.org/docs/2.4/mod/core.html#mutex&gt;);</span><br><span class="line"># you will save yourself a lot of trouble.</span><br><span class="line">#</span><br><span class="line"># Do NOT add a slash at the end of the directory path.</span><br><span class="line">#</span><br><span class="line">#ServerRoot &quot;/etc/apache2&quot;</span><br><span class="line"></span><br><span class="line">#</span><br><span class="line"># The accept serialization lock file MUST BE STORED ON A LOCAL DISK.</span><br><span class="line">#</span><br><span class="line">Mutex file:$&#123;APACHE_LOCK_DIR&#125; default</span><br><span class="line"></span><br><span class="line">#</span><br><span class="line"># PidFile: The file in which the server should record its process</span><br><span class="line"># identification number when it starts.</span><br><span class="line"># This needs to be set in /etc/apache2/envvars</span><br><span class="line">#</span><br><span class="line">PidFile $&#123;APACHE_PID_FILE&#125;</span><br><span class="line"></span><br><span class="line">#</span><br><span class="line"># Timeout: The number of seconds before receives and sends time out.</span><br><span class="line">#</span><br><span class="line">Timeout 300</span><br><span class="line"></span><br><span class="line">#</span><br><span class="line"># KeepAlive: Whether or not to allow persistent connections (more than</span><br><span class="line"># one request per connection). Set to &quot;Off&quot; to deactivate.</span><br><span class="line">#</span><br><span class="line">KeepAlive On</span><br><span class="line"></span><br><span class="line">#</span><br><span class="line"># MaxKeepAliveRequests: The maximum number of requests to allow</span><br><span class="line"># during a persistent connection. Set to 0 to allow an unlimited amount.</span><br><span class="line"># We recommend you leave this number high, for maximum performance.</span><br><span class="line">#</span><br><span class="line">MaxKeepAliveRequests 100</span><br><span class="line"></span><br><span class="line">#</span><br><span class="line"># KeepAliveTimeout: Number of seconds to wait for the next request from the</span><br><span class="line"># same client on the same connection.</span><br><span class="line">#</span><br><span class="line">KeepAliveTimeout 5</span><br><span class="line"></span><br><span class="line"># These need to be set in /etc/apache2/envvars</span><br><span class="line">User $&#123;APACHE_RUN_USER&#125;</span><br><span class="line">Group $&#123;APACHE_RUN_GROUP&#125;</span><br><span class="line"></span><br><span class="line">#</span><br><span class="line"># HostnameLookups: Log the names of clients or just their IP addresses</span><br><span class="line"># e.g., www.apache.org (on) or 204.62.129.132 (off).</span><br><span class="line"># The default is off because it&#x27;d be overall better for the net if people</span><br><span class="line"># had to knowingly turn this feature on, since enabling it means that</span><br><span class="line"># each client request will result in AT LEAST one lookup request to the</span><br><span class="line"># nameserver.</span><br><span class="line">#</span><br><span class="line">HostnameLookups Off</span><br><span class="line"></span><br><span class="line"># ErrorLog: The location of the error log file.</span><br><span class="line"># If you do not specify an ErrorLog directive within a &lt;VirtualHost&gt;</span><br><span class="line"># container, error messages relating to that virtual host will be</span><br><span class="line"># logged here.  If you *do* define an error logfile for a &lt;VirtualHost&gt;</span><br><span class="line"># container, that host&#x27;s errors will be logged there and not here.</span><br><span class="line">#</span><br><span class="line">ErrorLog $&#123;APACHE_LOG_DIR&#125;/error.log</span><br><span class="line"></span><br><span class="line">#</span><br><span class="line"># LogLevel: Control the severity of messages logged to the error_log.</span><br><span class="line"># Available values: trace8, ..., trace1, debug, info, notice, warn,</span><br><span class="line"># error, crit, alert, emerg.</span><br><span class="line"># It is also possible to configure the log level for particular modules, e.g.</span><br><span class="line"># &quot;LogLevel info ssl:warn&quot;</span><br><span class="line">#</span><br><span class="line">LogLevel warn</span><br><span class="line"></span><br><span class="line"># Include module configuration:</span><br><span class="line">IncludeOptional mods-enabled/*.load</span><br><span class="line">IncludeOptional mods-enabled/*.conf</span><br><span class="line"></span><br><span class="line"># Include list of ports to listen on</span><br><span class="line">Include ports.conf</span><br><span class="line"></span><br><span class="line"># Sets the default security model of the Apache2 HTTPD server. It does</span><br><span class="line"># not allow access to the root filesystem outside of /usr/share and /var/www.</span><br><span class="line"># The former is used by web applications packaged in Debian,</span><br><span class="line"># the latter may be used for local directories served by the web server. If</span><br><span class="line"># your system is serving content from a sub-directory in /srv you must allow</span><br><span class="line"># access here, or in any related virtual host.</span><br><span class="line">&lt;Directory /&gt;</span><br><span class="line">	Options FollowSymLinks</span><br><span class="line">	AllowOverride None</span><br><span class="line">	Require all denied</span><br><span class="line">&lt;/Directory&gt;</span><br><span class="line"></span><br><span class="line">&lt;Directory /usr/share&gt;</span><br><span class="line">	AllowOverride None</span><br><span class="line">	Require all granted</span><br><span class="line">&lt;/Directory&gt;</span><br><span class="line"></span><br><span class="line">&lt;Directory /var/www/&gt;</span><br><span class="line">	Options Indexes FollowSymLinks</span><br><span class="line">	AllowOverride None</span><br><span class="line">	Require all granted</span><br><span class="line">&lt;/Directory&gt;</span><br><span class="line"></span><br><span class="line">#&lt;Directory /srv/&gt;</span><br><span class="line">#	Options Indexes FollowSymLinks</span><br><span class="line">#	AllowOverride None</span><br><span class="line">#	Require all granted</span><br><span class="line">#&lt;/Directory&gt;</span><br><span class="line"></span><br><span class="line"># AccessFileName: The name of the file to look for in each directory</span><br><span class="line"># for additional configuration directives.  See also the AllowOverride</span><br><span class="line"># directive.</span><br><span class="line">#</span><br><span class="line">AccessFileName .htaccess</span><br><span class="line"></span><br><span class="line">#</span><br><span class="line"># The following lines prevent .htaccess and .htpasswd files from being</span><br><span class="line"># viewed by Web clients.</span><br><span class="line">#</span><br><span class="line">&lt;FilesMatch &quot;^.ht&quot;&gt;</span><br><span class="line">	Require all denied</span><br><span class="line">&lt;/FilesMatch&gt;</span><br><span class="line"></span><br><span class="line">#</span><br><span class="line"># The following directives define some format nicknames for use with</span><br><span class="line"># a CustomLog directive.</span><br><span class="line">#</span><br><span class="line"># These deviate from the Common Log Format definitions in that they use %O</span><br><span class="line"># (the actual bytes sent including headers) instead of %b (the size of the</span><br><span class="line"># requested file), because the latter makes it impossible to detect partial</span><br><span class="line"># requests.</span><br><span class="line">#</span><br><span class="line"># Note that the use of %&#123;X-Forwarded-For&#125;i instead of %h is not recommended.</span><br><span class="line"># Use mod_remoteip instead.</span><br><span class="line">#</span><br><span class="line">LogFormat &quot;%v:%p %h %l %u %t &quot;%r&quot; %&gt;s %O &quot;%&#123;Referer&#125;i&quot; &quot;%&#123;User-Agent&#125;i&quot;&quot; vhost_combined</span><br><span class="line">LogFormat &quot;%h %l %u %t &quot;%r&quot; %&gt;s %O &quot;%&#123;Referer&#125;i&quot; &quot;%&#123;User-Agent&#125;i&quot;&quot; combined</span><br><span class="line">LogFormat &quot;%h %l %u %t &quot;%r&quot; %&gt;s %O&quot; common</span><br><span class="line">LogFormat &quot;%&#123;Referer&#125;i -&gt; %U&quot; referer</span><br><span class="line">LogFormat &quot;%&#123;User-agent&#125;i&quot; agent</span><br><span class="line"></span><br><span class="line"># Include of directories ignores editors&#x27; and dpkg&#x27;s backup files,</span><br><span class="line"># see README.Debian for details.</span><br><span class="line"></span><br><span class="line"># Include generic snippets of statements</span><br><span class="line">IncludeOptional conf-enabled/*.conf</span><br><span class="line"></span><br><span class="line"># Include the virtual host configurations:</span><br><span class="line">IncludeOptional sites-enabled/*.conf</span><br><span class="line"></span><br><span class="line"># vim: syntax=apache ts=4 sw=4 sts=4 sr noet</span><br></pre></td></tr></table></figure>
<p>注意这当中的一段：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">&lt;Directory /&gt;</span><br><span class="line">	Options FollowSymLinks</span><br><span class="line">	AllowOverride None</span><br><span class="line">	Require all denied</span><br><span class="line">&lt;/Directory&gt;</span><br><span class="line"></span><br><span class="line">&lt;Directory /usr/share&gt;</span><br><span class="line">	AllowOverride None</span><br><span class="line">	Require all granted</span><br><span class="line">&lt;/Directory&gt;</span><br><span class="line"></span><br><span class="line">&lt;Directory /var/www/&gt;</span><br><span class="line">	Options Indexes FollowSymLinks</span><br><span class="line">	AllowOverride None</span><br><span class="line">	Require all granted</span><br><span class="line">&lt;/Directory&gt;</span><br></pre></td></tr></table></figure>
<p>由这段可以很容易的知道apache2到底为哪些文件夹赋予了打开的权限了。以后就可以通过修改这里达到各种不可告人的目的了。</p>
<p>最后还有一个重要的配置，就是默认目录的更改。默认的目录其实是记录在:&#x2F;etc&#x2F;apache2&#x2F;sites-available&#x2F;000-default.conf 文件当中（在&#x2F;etc&#x2F;apache2&#x2F;sites-enable&#x2F;中也有一个指向他的链接）：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">myths@myths-X450LD:/etc/apache2/sites-available$ cat 000-default.conf </span><br><span class="line">&lt;VirtualHost *:80&gt;</span><br><span class="line">	# The ServerName directive sets the request scheme, hostname and port that</span><br><span class="line">	# the server uses to identify itself. This is used when creating</span><br><span class="line">	# redirection URLs. In the context of virtual hosts, the ServerName</span><br><span class="line">	# specifies what hostname must appear in the request&#x27;s Host: header to</span><br><span class="line">	# match this virtual host. For the default virtual host (this file) this</span><br><span class="line">	# value is not decisive as it is used as a last resort host regardless.</span><br><span class="line">	# However, you must set it for any further virtual host explicitly.</span><br><span class="line">	#ServerName www.example.com</span><br><span class="line"></span><br><span class="line">	ServerAdmin webmaster@localhost</span><br><span class="line">	DocumentRoot /var/www/html</span><br><span class="line"></span><br><span class="line">	# Available loglevels: trace8, ..., trace1, debug, info, notice, warn,</span><br><span class="line">	# error, crit, alert, emerg.</span><br><span class="line">	# It is also possible to configure the loglevel for particular</span><br><span class="line">	# modules, e.g.</span><br><span class="line">	#LogLevel info ssl:warn</span><br><span class="line"></span><br><span class="line">	ErrorLog $&#123;APACHE_LOG_DIR&#125;/error.log</span><br><span class="line">	CustomLog $&#123;APACHE_LOG_DIR&#125;/access.log combined</span><br><span class="line"></span><br><span class="line">	# For most configuration files from conf-available/, which are</span><br><span class="line">	# enabled or disabled at a global level, it is possible to</span><br><span class="line">	# include a line for only one particular virtual host. For example the</span><br><span class="line">	# following line enables the CGI configuration for this host only</span><br><span class="line">	# after it has been globally disabled with &quot;a2disconf&quot;.</span><br><span class="line">	#Include conf-available/serve-cgi-bin.conf</span><br><span class="line">&lt;/VirtualHost&gt;</span><br><span class="line"></span><br><span class="line"># vim: syntax=apache ts=4 sw=4 sts=4 sr noet</span><br></pre></td></tr></table></figure>
<p>当中的“DocumentRoot ”键对应的值就是默认的目录了，可以任由我们修改了。</p>
<p>apache2的简单配置基本就是这些，不需要百度，我们也是完全可以自己弄清楚的。</p>
<p>注：</p>
<ol>
<li>修改完配置文件后记得重启服务</li>
<li>可以顺手吧&#x2F;var&#x2F;www的权限设置为777方便修改网页</li>
</ol>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://www.resonanat.com/2015/11/03/Linux%E4%B8%ADln%E5%91%BD%E4%BB%A4%E7%9A%84%E7%94%A8%E6%B3%95%E4%BB%A5%E5%8F%8A%E5%88%86%E6%9E%90/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Resive world">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2015/11/03/Linux%E4%B8%ADln%E5%91%BD%E4%BB%A4%E7%9A%84%E7%94%A8%E6%B3%95%E4%BB%A5%E5%8F%8A%E5%88%86%E6%9E%90/" itemprop="url">Linux中ln命令的用法以及分析</a></h2>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2015-11-03T15:44:41+00:00">
                2015-11-03
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Linux/" itemprop="url" rel="index">
                    <span itemprop="name">Linux</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>在ubuntu用也有类似于windows中快捷方式这种类型的东西，即链接。这里一般使用ln命令来执行得到，ln命令用法简单，但是与windows不同，这里有硬链接和软链接两种类型的链接。在介绍两种链接的时候，我们先来了解一下Linux的文件系统。</p>
<h2 id="文件系统"><a href="#文件系统" class="headerlink" title="文件系统"></a>文件系统</h2><p>在Linux中每一个文件大体上由三个部分组成：</p>
<ol>
<li>文件名：这个是用来标记这个文件的符号，也就是我们所理解的文件名；</li>
<li>inode：inode存放的是文件的metadata，也就是元信息，包括了文件的权限、创建时间、修改时间、唯一id、文件种类、一个与文件名数目对应的链接数，最后还有一个指向实际数据区域的指针。我们可以用stat命令来查看文件的inode信息。</li>
<li>数据区：这里是真正保存数据的地方。</li>
</ol>
<p>当我们创建一个文件的时候，我们实际上是创建了这个文件的文件名以及inode，只有当我们真正写数据的时候，我们才会想数据区里写入数据。<br>当我们删除一个文件的时候，我们实际上是删除了这个文件的文件名，然后这个文件对应的inode的连接数会减一，当这个连接数减为0的时候，操作系统才会讲这个inode删除，也就是删除了这个文件。</p>
<h2 id="硬链接"><a href="#硬链接" class="headerlink" title="硬链接"></a>硬链接</h2><p><img src="/images/2015/11/03/1/1.png"></p>
<p>硬链接相当于给文件重新起了一个名字，没有创建inode，只是对inode的链接数加了1，更没有数据的拷贝，新创建的名字与原来的名字从本质上没有任何先后次序，是对等存在的。对一个文件的修改就是对另一个文件的修改。当删除一个文件的时候，只是删除了这个文件名，并且将对应inode的链接数减了1。</p>
<p>硬链接还有一些非常有趣的性质：</p>
<h3 id="不允许给目录创建硬链接"><a href="#不允许给目录创建硬链接" class="headerlink" title="不允许给目录创建硬链接"></a>不允许给目录创建硬链接</h3><p>为什么不允许给目录创建硬链接呢？原因其实非常好玩。事实上Linux对目录本身是有硬链接的，我们知道每一个文件夹下都至少会有两个链接，一个是’.’、表示当前文件本身；另一个是’..’、表示当前文件的父目录。事实上，这个’.’就是对当前文件的一个硬链接，而’..’是对当前文件夹的父目录的硬链接，这就是为什么如果我们新建一个文件夹后，用stat查看这个文件夹的链接数，会发现这个数至少是2而不是1。<br>既然有硬链接，那么为什么不允许用户创建呢？原因也很有趣。如果任由用户随意添加硬链接，那么很容易出现一种情况，就是比如dir1-&gt;dir3 , dir2-&gt;dir3，这时如果我们在dir3下执行cd .. ，那么我们应该跳到哪里呢？显然这是一个不可描述的问题。因此，为了避免这种情况的发生，Linux的设计者才做了这样一个规定。</p>
<h3 id="只有在同一文件系统中的文件之间才能创建链接。"><a href="#只有在同一文件系统中的文件之间才能创建链接。" class="headerlink" title="只有在同一文件系统中的文件之间才能创建链接。"></a>只有在同一文件系统中的文件之间才能创建链接。</h3><p>这一点跟软链接不同，由于硬链接中的两个文件名需要映射到同一个inode上，而这个文件系统的inode显然不能被另一个文件系统直接看到，因此也就不能跨文件系统访问了。</p>
<p>事实上，硬链接用的不多，比较常用的是软链接：</p>
<h2 id="软链接"><a href="#软链接" class="headerlink" title="软链接"></a>软链接</h2><p><img src="/images/2015/11/03/1/2.png"></p>
<p>软链接又叫符号链接，就是传统意义上windows中的那种链接，本身可以看做是一种指针，指向实际的文件。</p>
<p>具体ln命令的用法：</p>
<p>ln 源文件 目标文件        &#x2F;&#x2F;默认创建硬链接</p>
<p>ln -s 源文件 目标文件    &#x2F;&#x2F;加-s （symbolic）选项创建软链接</p>
<p>创建的软链接在用ls -l 查看的时候是会显示细节的，比如：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">myths@myths-X450LD:~/test$ <span class="built_in">ln</span> -s a.txt b.txt</span><br><span class="line">myths@myths-X450LD:~/test$ <span class="built_in">ls</span></span><br><span class="line">a.txt  b.txt</span><br><span class="line">myths@myths-X450LD:~/test$ <span class="built_in">ls</span> -l</span><br><span class="line">总用量 4</span><br><span class="line">-rw-rw-r-- 1 myths myths 6 11月  6 00:27 a.txt</span><br><span class="line">lrwxrwxrwx 1 myths myths 5 11月  6 00:29 b.txt -&gt; a.txt</span><br><span class="line">myths@myths-X450LD:~/test$</span><br></pre></td></tr></table></figure>
<p>这里权限的第一个位置写的是  l  表明这是一个软链接，而且最后还会有一个箭头指向实际的文件。</p>
<p>当然也可以用readlink 命令来显示链接目的地：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">myths@myths-X450LD:~/test$ readlink  b.txt</span><br><span class="line">a.txt</span><br></pre></td></tr></table></figure>
<p>实际中用到软链接的地方是很多的，比如显示网站的时候，一般将index.html指向实际想执行的文件来默认显示网站打开的网页。</p>
<h2 id="参考文献"><a href="#参考文献" class="headerlink" title="参考文献"></a>参考文献</h2><p><a target="_blank" rel="noopener" href="https://www.cs.nmsu.edu/~pfeiffer/classes/474/notes/inodefs.html">NMSU CS课件</a></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://www.resonanat.com/2015/11/02/Qt%E4%B8%AD%E5%9F%BA%E6%9C%AC%E7%9A%84%E7%BB%98%E5%9B%BE%E6%96%B9%E6%B3%95/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Resive world">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2015/11/02/Qt%E4%B8%AD%E5%9F%BA%E6%9C%AC%E7%9A%84%E7%BB%98%E5%9B%BE%E6%96%B9%E6%B3%95/" itemprop="url">Qt中基本的绘图方法</a></h2>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2015-11-02T14:17:58+00:00">
                2015-11-02
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Qt/" itemprop="url" rel="index">
                    <span itemprop="name">Qt</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>Qt中实现绘图功能和其他的库差不多，主要靠Painter，Pen，Brush之类的东西进行描绘。这里主要牵涉到QPainter，QPen，QBrush三个类，用法也很简单。下面主要是实现一个全面显示各种图形的程序，定义了两个类，一个负责绘图区，一个负责用户交互，这里先介绍绘图区的类。</p>
<h2 id="Painter-pro"><a href="#Painter-pro" class="headerlink" title="Painter.pro"></a>Painter.pro</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">#-------------------------------------------------</span><br><span class="line">#</span><br><span class="line"># Project created by QtCreator <span class="number">2015</span><span class="number">-11</span><span class="number">-02</span>T18:<span class="number">38</span>:<span class="number">46</span></span><br><span class="line">#</span><br><span class="line">#-------------------------------------------------</span><br><span class="line"></span><br><span class="line">QT       += core gui</span><br><span class="line"></span><br><span class="line"><span class="built_in">greaterThan</span>(QT_MAJOR_VERSION, <span class="number">4</span>): QT += widgets</span><br><span class="line"></span><br><span class="line">TARGET = Painter</span><br><span class="line">TEMPLATE = app</span><br><span class="line"></span><br><span class="line">SOURCES += main.cpp </span><br><span class="line">    painter.cpp </span><br><span class="line">    widget.cpp</span><br><span class="line"></span><br><span class="line">HEADERS  += </span><br><span class="line">    painter.h </span><br><span class="line">    widget.h</span><br></pre></td></tr></table></figure>
<h2 id="painter-h"><a href="#painter-h" class="headerlink" title="painter.h"></a>painter.h</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">ifndef</span> WIDGET_H</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> WIDGET_H</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;QWidget&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;QBrush&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;QPen&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;QPainter&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;QRect&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;QPoint&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;QDebug&gt;</span></span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Painter</span> : <span class="keyword">public</span> QWidget</span><br><span class="line">&#123;</span><br><span class="line">    Q_OBJECT</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="built_in">Painter</span>(QWidget *parent = <span class="number">0</span>);</span><br><span class="line">    ~<span class="built_in">Painter</span>();</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="comment">//枚举所有类型的图形</span></span><br><span class="line">    <span class="keyword">enum</span> <span class="title class_">Shape</span>&#123;Line,Rectangle,RoundRect,Ellipse,Polygon,Polyline,Points,Arc,Path,Text,Pixmap&#125;;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">setShape</span><span class="params">(Shape)</span></span>;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">setPen</span><span class="params">(QPen)</span></span>;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">setBrush</span><span class="params">(QBrush)</span></span>;</span><br><span class="line">    <span class="comment">//重写重绘事件</span></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">paintEvent</span><span class="params">(QPaintEvent*)</span></span>;</span><br><span class="line"><span class="keyword">private</span> :</span><br><span class="line">    Shape shape;</span><br><span class="line">    QBrush brush;</span><br><span class="line">    QPen pen;</span><br><span class="line"></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">endif</span> <span class="comment">// WIDGET_H</span></span></span><br></pre></td></tr></table></figure>
<h2 id="painter-cpp"><a href="#painter-cpp" class="headerlink" title="painter.cpp"></a>painter.cpp</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;painter.h&quot;</span></span></span><br><span class="line"></span><br><span class="line">Painter::<span class="built_in">Painter</span>(QWidget *parent)</span><br><span class="line">    : <span class="built_in">QWidget</span>(parent)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">setPalette</span>(<span class="built_in">QPalette</span>(Qt::white));<span class="comment">//设置背景</span></span><br><span class="line">    <span class="built_in">setAutoFillBackground</span>(<span class="literal">true</span>);</span><br><span class="line">    <span class="built_in">setMinimumSize</span>(<span class="number">400</span>,<span class="number">400</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Painter::~<span class="built_in">Painter</span>()</span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">Painter::setShape</span><span class="params">(Shape s)</span></span>&#123;</span><br><span class="line">    shape=s;</span><br><span class="line">    <span class="built_in">update</span>();<span class="comment">//调用qwidget的update()来更新状态</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">Painter::setPen</span><span class="params">(QPen p)</span></span>&#123;</span><br><span class="line">    pen=p;</span><br><span class="line">    <span class="built_in">update</span>();</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">Painter::setBrush</span><span class="params">(QBrush b)</span></span>&#123;</span><br><span class="line">    brush=b;</span><br><span class="line">    <span class="built_in">update</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">Painter::paintEvent</span><span class="params">(QPaintEvent *)</span></span>&#123;</span><br><span class="line">    <span class="built_in">qDebug</span>()&lt;&lt;<span class="string">&quot;debug 2&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function">QPainter <span class="title">p</span><span class="params">(<span class="keyword">this</span>)</span></span>;<span class="comment">//拿到当前的画笔句柄</span></span><br><span class="line"></span><br><span class="line">    p.<span class="built_in">setPen</span>(pen);</span><br><span class="line">    p.<span class="built_in">setBrush</span>(brush);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//留一个Qrect备用</span></span><br><span class="line">    <span class="function">QRect <span class="title">rect</span><span class="params">(<span class="number">50</span>,<span class="number">100</span>,<span class="number">300</span>,<span class="number">200</span>)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//留一个QPoint 数组备用</span></span><br><span class="line">    <span class="type">static</span> <span class="type">const</span> QPoint points[<span class="number">4</span>]=&#123;</span><br><span class="line">        <span class="built_in">QPoint</span>(<span class="number">150</span>,<span class="number">100</span>),</span><br><span class="line">        <span class="built_in">QPoint</span>(<span class="number">300</span>,<span class="number">150</span>),</span><br><span class="line">        <span class="built_in">QPoint</span>(<span class="number">350</span>,<span class="number">250</span>),</span><br><span class="line">        <span class="built_in">QPoint</span>(<span class="number">100</span>,<span class="number">300</span>),</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//留几个角度备用</span></span><br><span class="line">    <span class="type">int</span> startAngle=<span class="number">30</span>*<span class="number">16</span>;</span><br><span class="line">    <span class="type">int</span> spanAngle=<span class="number">120</span>*<span class="number">16</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//留一个QPainterPath备用</span></span><br><span class="line">    QPainterPath path;</span><br><span class="line">    path.<span class="built_in">addRect</span>(<span class="number">150</span>,<span class="number">150</span>,<span class="number">100</span>,<span class="number">100</span>);</span><br><span class="line">    path.<span class="built_in">moveTo</span>(<span class="number">100</span>,<span class="number">100</span>);</span><br><span class="line">    path.<span class="built_in">cubicTo</span>(<span class="number">300</span>,<span class="number">100</span>,<span class="number">200</span>,<span class="number">200</span>,<span class="number">300</span>,<span class="number">300</span>);</span><br><span class="line">    path.<span class="built_in">cubicTo</span>(<span class="number">100</span>,<span class="number">300</span>,<span class="number">200</span>,<span class="number">200</span>,<span class="number">100</span>,<span class="number">100</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//根据选择的shape分别显示</span></span><br><span class="line">    <span class="keyword">switch</span>(shape)&#123;</span><br><span class="line">    <span class="keyword">case</span> Line:<span class="comment">//直线</span></span><br><span class="line">        p.<span class="built_in">drawLine</span>(rect.<span class="built_in">topLeft</span>(),rect.<span class="built_in">bottomRight</span>());</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> Rectangle:<span class="comment">//矩形</span></span><br><span class="line">        p.<span class="built_in">drawRect</span>(rect);</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> RoundRect:<span class="comment">//圆角矩形</span></span><br><span class="line">        p.<span class="built_in">drawRoundRect</span>(rect);</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> Ellipse:<span class="comment">//椭圆</span></span><br><span class="line">        p.<span class="built_in">drawEllipse</span>(rect);</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> Polygon:<span class="comment">//多边形</span></span><br><span class="line">        p.<span class="built_in">drawPolygon</span>(points,<span class="number">4</span>);</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> Polyline:<span class="comment">//多边线</span></span><br><span class="line">        p.<span class="built_in">drawPolyline</span>(points,<span class="number">4</span>);</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> Points:<span class="comment">//点</span></span><br><span class="line">        p.<span class="built_in">drawPoints</span>(points,<span class="number">4</span>);</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> Arc:<span class="comment">//弧线</span></span><br><span class="line">        p.<span class="built_in">drawArc</span>(rect,startAngle,spanAngle);</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> Path:<span class="comment">//路径</span></span><br><span class="line">        p.<span class="built_in">drawPath</span>(path);</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> Text:<span class="comment">//文字</span></span><br><span class="line">        p.<span class="built_in">drawText</span>(rect,Qt::AlignCenter,<span class="string">&quot;Hello Qt!&quot;</span>);</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line"><span class="comment">//  case Pixmap://图片</span></span><br><span class="line"><span class="comment">//      p.drawPixmap(150,150,QPixmap(&quot;homemythstest.png&quot;));</span></span><br><span class="line"><span class="comment">//      break;</span></span><br><span class="line">    <span class="keyword">default</span>:</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="main-cpp"><a href="#main-cpp" class="headerlink" title="main.cpp"></a>main.cpp</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;painter.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;QApplication&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">char</span> *argv[])</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="function">QApplication <span class="title">a</span><span class="params">(argc, argv)</span></span>;</span><br><span class="line">    Widget w;</span><br><span class="line">    w.<span class="built_in">show</span>();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> a.<span class="built_in">exec</span>();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://www.resonanat.com/2015/10/31/Visual-Studio-%E7%B3%BB%E5%88%97%E8%B0%83%E8%AF%95%E6%96%B9%E6%B3%95%E6%95%B4%E7%90%86/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Resive world">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2015/10/31/Visual-Studio-%E7%B3%BB%E5%88%97%E8%B0%83%E8%AF%95%E6%96%B9%E6%B3%95%E6%95%B4%E7%90%86/" itemprop="url">Visual Studio 系列调试方法整理</a></h2>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2015-10-31T15:27:49+00:00">
                2015-10-31
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/C-C/" itemprop="url" rel="index">
                    <span itemprop="name">C/C++</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>学编程不会调试，这简直就跟做买卖不会数钱一样好笑，有时候程序出了bug，思维受限的时候，肉眼是很难判断出错误的地方的，虽然调试不一定非得用Debug模式来进行，但是使用vs系列的Debug模式的确是个比较方便的好办法。</p>
<p>首先介绍一些快捷键：</p>
<h2 id="Ctrl-F5-键"><a href="#Ctrl-F5-键" class="headerlink" title="Ctrl + F5 键"></a>Ctrl + F5 键</h2><p>这个就是直接运行程序，不会在任何断点处下来，所以实际上并不属于Debug模式的范畴，而是直接运行程序了。这样运行的程序结束后会自动pause一下，所以比较方便的能查看程序运行的结果，而不会出现所谓的“闪退”。</p>
<h2 id="开启Debug模式"><a href="#开启Debug模式" class="headerlink" title="开启Debug模式"></a>开启Debug模式</h2><h2 id="F5键"><a href="#F5键" class="headerlink" title="F5键"></a>F5键</h2><p>表示开始调试，如果程序设置了断点，或者需要从控制台读入数据，那么会在断电处或者输入数据的地方停止下来，否则将运行程序直到结束，而当程序结束的时候，他会直接结束调试模式，可以说是一种“闪退”，这是正常现象。这个键我个人一般不会用，通常会用F10来ctrl+F10来代替。</p>
<h2 id="F10键"><a href="#F10键" class="headerlink" title="F10键"></a>F10键</h2><p>单步执行（逐过程），按下F10键后，会在代码的左边出现一个箭头，表示当前程序运行到的地方（当前行并未执行）。每按一次，程序就会向下运行一行，直到程序结束。注意当运行到调用函数的地方的时候，会跳过函数体的内部的运行细节而直接运行到函数返回后的结果。</p>
<h2 id="Ctrl-F10-键"><a href="#Ctrl-F10-键" class="headerlink" title="Ctrl + F10 键"></a>Ctrl + F10 键</h2><p>直接运行到光标所在位置（光标所在位置不表示鼠标指针所在位置。。不要犯傻哦），简单暴力。</p>
<h2 id="F11键"><a href="#F11键" class="headerlink" title="F11键"></a>F11键</h2><p>单步执行（逐语句），基本作用与F10一样，唯一的不同是，当运行到调用函数的时候，按下该键会直接进入函数体内部，比如scanf函数之类的（这显然是我们不需要知道的），一般情况下如果我们确实想进入函数内部看看，我都会直接用Ctrl + F10直接进去，而不是F11 F11的慢慢走。</p>
<h2 id="F9键"><a href="#F9键" class="headerlink" title="F9键"></a>F9键</h2><p>设置和取消断点，会在当前代码行前出现一个红点点，当然直接在代码行前单击一下也可以设置和取消断点，所以这个键比较鸡肋，也不常用。</p>
<hr>
<p>通过以上的方法，我们进入了Debug模式，进入了这个模式，我们就可以做很多事情了，最简单的事情就是查看单个变量运行时的值。想要做到这一点我们只需要把鼠标指针移到想要查看的光标上，光标旁边就会出现他的值了：</p>
<p><img src="/images/2015/10/31/1/1.png"></p>
<p>当然，如果想查看一个数组各个元素的值，我们可以把鼠标放在数组名上，就会出现这样的下拉界面：</p>
<p><img src="/images/2015/10/31/1/2.png"></p>
<p>就可以方便的看到了各个数值了。</p>
<p>当然，如果想更加清楚的看各个数字的变化的话，我们可以调出添加监视的界面。右键某一个变量，选择添加监视：</p>
<p><img src="/images/2015/10/31/1/3.png"></p>
<p>点开后这样就会出现一下的一个界面：</p>
<p><img src="/images/2015/10/31/1/4.png"></p>
<p>这个窗口的“名称”部分，我们可以写入我们需要查看的变量的名字，右边会显示他对应的当前的值。如果名字是一个数组，那么他的值显示的是他数组的首地址（没什么卵用），但是我们可以点开名称前面的小三角，来显示出数组中各个元素的值。</p>
<h2 id="关闭Debug模式"><a href="#关闭Debug模式" class="headerlink" title="关闭Debug模式"></a>关闭Debug模式</h2><p>在Debug模式下，点击窗口的红叉叉实际上是关闭不了的，我们当然可以在菜单中选择停止调试，但是这样显然很cuo（第二声）（实际上按按钮的行为都很cuo（第二声），所以我把我的按钮那一栏都直接取消了，是不是看上去非常干净0.0），快捷的做法是按shift + F5 这样就可以结束Debug模式而到正常的码代码的模式了。</p>
<hr>
<p>以上是最基本的Debug方法了，这是最基本的调试方法，每一个人都必须要掌握。</p>
<p>以下是一些比较高级的调试手段了，说高级，并不是说有多难掌握，只是说相对于基础的调试方法来说，这种方法更加快捷，方便程序员使用，他们的关系，我觉得就像各种运行库之于操作系统所提供的API一样，前者是对后者的封装和简化，有兴趣的同学可以来研究研究。</p>
<p>当我们右键设置的断点的时候，我们会发现这样的菜单：</p>
<p><img src="/images/2015/10/31/1/5.png"></p>
<p>这里我们常用的就是 “条件”选项，和“命中次数”选项，我说了，由于这是“高级”调试手段，所以操作界面十分的User-friendly，应该打开就会用了，我就不赘述了。</p>
<p>注：</p>
<ul>
<li>个人比较建议大家不要用按钮（这样显得特别的怂），多用快捷键，这样会提高很多的效率。</li>
<li>建议大家都把行号加起来（具体方法请自行百度）</li>
<li>有兴趣的同学可以用一个叫VassistX的插件来辅助你的vs2010（好处谁用谁知道），或者升级到vs2013</li>
</ul>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://www.resonanat.com/2015/10/30/Qt%E4%B8%ADLNK2019%E9%94%99%E8%AF%AF%E7%9A%84%E8%A7%A3%E5%86%B3%E5%8A%9E%E6%B3%95/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Resive world">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2015/10/30/Qt%E4%B8%ADLNK2019%E9%94%99%E8%AF%AF%E7%9A%84%E8%A7%A3%E5%86%B3%E5%8A%9E%E6%B3%95/" itemprop="url">Qt中LNK2019错误的解决办法</a></h2>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2015-10-30T14:31:20+00:00">
                2015-10-30
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Qt/" itemprop="url" rel="index">
                    <span itemprop="name">Qt</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>在写Qt 网络编程的程序时，有时候会遇到</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dialog.obj:-1: error: LNK2019: 无法解析的外部符号 &quot;__declspec(dllimport) public: virtual __cdecl QNetworkAccessManager::~QNetworkAccessManager(void)&quot; (__imp\_??1QNetworkAccessManager@@UEAA@XZ)，该符号在函数 &quot;protected: void __cdecl Dialog::slotLogin(void)&quot; (?slotLogin@Dialog@@IEAAXXZ) 中被引用</span><br></pre></td></tr></table></figure>
<p>这类的错误，让人十分头大。</p>
<p>这个错误大多是因为没有按照要求导入相应的链接库，以至于无法调用相应的类库。在vs或者codeblocks环境下可以通过选项设置之类的东西添加相应的链接库。但是在Qt Creator默认是没有这种东西的，而是提供了另一种途径，即每个项目必然会有的.pro文件，类似于：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">#-------------------------------------------------</span><br><span class="line">#</span><br><span class="line"># Project created by QtCreator <span class="number">2015</span><span class="number">-10</span><span class="number">-29</span>T23:<span class="number">52</span>:<span class="number">56</span></span><br><span class="line">#</span><br><span class="line">#-------------------------------------------------</span><br><span class="line"></span><br><span class="line">QT       += core gui</span><br><span class="line"></span><br><span class="line"><span class="built_in">greaterThan</span>(QT_MAJOR_VERSION, <span class="number">4</span>): QT += widgets</span><br><span class="line"></span><br><span class="line">TARGET = Dialog</span><br><span class="line">TEMPLATE = app</span><br><span class="line"></span><br><span class="line">SOURCES += main.cpp</span><br><span class="line">        dialog.cpp</span><br><span class="line"></span><br><span class="line">HEADERS  += dialog.h</span><br></pre></td></tr></table></figure>
<p>这个文件主要是给qmake用的，具体也没有必要了解。一般是系统生成的默认值就行了，只有当我们需要导入链接库的时候才有用。比如当我们需要用QNetworkAccessManager这个类的时候，我们需要在这当中加入一句话：<code>QT += network</code>即可，这样在构建的时候就会导入network这一系列的库。这个network从哪来的呢？实际上，在Qt Creator自带的帮助文档中已经告诉我们了，在QNetworkAccessManager中有相应的说明：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Header:		#include &lt;QNetworkAccessManager&gt;</span><br><span class="line">qmake:		QT += network</span><br><span class="line">Since:		Qt 4.4</span><br><span class="line">Inherits:	QObject</span><br></pre></td></tr></table></figure>
<p>有了这个说明，那么解决方案就很明显了。</p>
<p>但是还有一点需要注意，就是在修改过.pro 文件之后，需要手动将系统之前在上一级目录下生成出来的build文件夹删除之后才能使该文件生效。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://www.resonanat.com/2015/10/29/Qt%E5%AE%9E%E7%8E%B0FTP%E7%9A%84%E4%B8%8A%E4%BC%A0%E5%92%8C%E4%B8%8B%E8%BD%BD/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Resive world">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2015/10/29/Qt%E5%AE%9E%E7%8E%B0FTP%E7%9A%84%E4%B8%8A%E4%BC%A0%E5%92%8C%E4%B8%8B%E8%BD%BD/" itemprop="url">Qt实现FTP的上传和下载</a></h2>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2015-10-29T15:51:32+00:00">
                2015-10-29
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Qt/" itemprop="url" rel="index">
                    <span itemprop="name">Qt</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>本来想简单抄抄书，随便手写个Ftp客户端的，结果发现教材上的是基于Qt4的QFtp类库，而在Qt5中取消了这一个类库（同时也取消了QHttp等的类），取而代之的是QNetworkAccessManager 这个类，把这些杂货全都揽下来了，据说是因为之前的两个类有重复而且效率有问题balabala。于是就百度了一下，发现百度上要么讲的不全，要么就是要去下一个由热心网民重新封装的QFtp类。显然我并不喜欢无脑复制粘贴，想好好看下Qt官方提供的东西的用法，深入的理解下Qt网络编程，于是就果断自行google（话说google真好用），加上查看帮助文档，终于把一个简版的Ftp客户端大概框架弄清楚了。</p>
<p>不多说，上源码：</p>
<h2 id="Dialog-pro"><a href="#Dialog-pro" class="headerlink" title="Dialog.pro"></a>Dialog.pro</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">#-------------------------------------------------</span><br><span class="line">#</span><br><span class="line"># Project created by QtCreator <span class="number">2015</span><span class="number">-10</span><span class="number">-29</span>T23:<span class="number">52</span>:<span class="number">56</span></span><br><span class="line">#</span><br><span class="line">#-------------------------------------------------</span><br><span class="line"></span><br><span class="line">QT       += core gui</span><br><span class="line">QT       += network  #这里要添加这个库</span><br><span class="line"></span><br><span class="line"><span class="built_in">greaterThan</span>(QT_MAJOR_VERSION, <span class="number">4</span>): QT += widgets</span><br><span class="line"></span><br><span class="line">TARGET = QFtp</span><br><span class="line">TEMPLATE = app</span><br><span class="line"></span><br><span class="line">SOURCES += main.cpp</span><br><span class="line">        dialog.cpp</span><br><span class="line"></span><br><span class="line">HEADERS  += dialog.h</span><br></pre></td></tr></table></figure>
<h2 id="dialog-h"><a href="#dialog-h" class="headerlink" title="dialog.h"></a>dialog.h</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">ifndef</span> DIALOG_H</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> DIALOG_H</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//注意需要添加的头文件</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;QDialog&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;QPushButton&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;QFile&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;QNetworkReply&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;QLineEdit&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;QtNetwork/QNetworkAccessManager&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;QtNetwork/QNetworkRequest&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;QLabel&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;QString&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;QGridLayout&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;QMessageBox&gt;</span></span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Dialog</span> : <span class="keyword">public</span> QDialog</span><br><span class="line">&#123;</span><br><span class="line">    Q_OBJECT</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="built_in">Dialog</span>(QWidget *parent = <span class="number">0</span>);</span><br><span class="line">    ~<span class="built_in">Dialog</span>();</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    QGridLayout *layout;</span><br><span class="line">    QLabel *LbServer,*LbUser,*LbPasswd;</span><br><span class="line">    QLineEdit *LeServer,*LeUser,*LePasswd;</span><br><span class="line">    QPushButton *PbPut,*PbGet;</span><br><span class="line">    QNetworkAccessManager manager;<span class="comment">//这个是重点</span></span><br><span class="line"><span class="keyword">protected</span> slots:</span><br><span class="line">    <span class="comment">//处理按钮的点击信号</span></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">slotPut</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">slotGet</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="comment">//处理网络连接的信号</span></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">managePut</span><span class="params">(QNetworkReply*)</span></span>;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">manageGet</span><span class="params">(QNetworkReply*)</span></span>;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">endif</span> <span class="comment">// DIALOG_H</span></span></span><br></pre></td></tr></table></figure>
<h2 id="dialog-cpp"><a href="#dialog-cpp" class="headerlink" title="dialog.cpp"></a>dialog.cpp</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;dialog.h&quot;</span></span></span><br><span class="line"></span><br><span class="line">Dialog::<span class="built_in">Dialog</span>(QWidget *parent)</span><br><span class="line">    : <span class="built_in">QDialog</span>(parent)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">setWindowTitle</span>(<span class="string">&quot;My Ftp&quot;</span>);</span><br><span class="line"></span><br><span class="line">    layout=<span class="keyword">new</span> <span class="built_in">QGridLayout</span>(<span class="keyword">this</span>);</span><br><span class="line">    LbServer=<span class="keyword">new</span> <span class="built_in">QLabel</span>(<span class="string">&quot;Server:&quot;</span>);</span><br><span class="line">    LbUser=<span class="keyword">new</span> <span class="built_in">QLabel</span>(<span class="string">&quot;User:&quot;</span>);</span><br><span class="line">    LbPasswd=<span class="keyword">new</span> <span class="built_in">QLabel</span>(<span class="string">&quot;Passwd:&quot;</span>);</span><br><span class="line">    LeServer=<span class="keyword">new</span> <span class="built_in">QLineEdit</span>(<span class="string">&quot;ftp://120.27.41.126/home/myths/1.txt&quot;</span>);</span><br><span class="line">    LeUser=<span class="keyword">new</span> <span class="built_in">QLineEdit</span>(<span class="string">&quot;myths&quot;</span>);</span><br><span class="line">    LePasswd=<span class="keyword">new</span> <span class="built_in">QLineEdit</span>(<span class="string">&quot;123456&quot;</span>);</span><br><span class="line">    LePasswd-&gt;<span class="built_in">setEchoMode</span>(QLineEdit::Password);<span class="comment">//设置加密显示</span></span><br><span class="line">    PbPut=<span class="keyword">new</span> <span class="built_in">QPushButton</span>(<span class="string">&quot;Put&quot;</span>);</span><br><span class="line">    PbGet=<span class="keyword">new</span> <span class="built_in">QPushButton</span>(<span class="string">&quot;Get&quot;</span>);</span><br><span class="line"></span><br><span class="line">    layout-&gt;<span class="built_in">addWidget</span>(LbServer,<span class="number">0</span>,<span class="number">0</span>);</span><br><span class="line">    layout-&gt;<span class="built_in">addWidget</span>(LeServer,<span class="number">0</span>,<span class="number">1</span>);</span><br><span class="line">    layout-&gt;<span class="built_in">addWidget</span>(LbUser,<span class="number">1</span>,<span class="number">0</span>);</span><br><span class="line">    layout-&gt;<span class="built_in">addWidget</span>(LeUser,<span class="number">1</span>,<span class="number">1</span>);</span><br><span class="line">    layout-&gt;<span class="built_in">addWidget</span>(LbPasswd,<span class="number">2</span>,<span class="number">0</span>);</span><br><span class="line">    layout-&gt;<span class="built_in">addWidget</span>(LePasswd,<span class="number">2</span>,<span class="number">1</span>);</span><br><span class="line">    layout-&gt;<span class="built_in">addWidget</span>(PbPut,<span class="number">3</span>,<span class="number">0</span>);</span><br><span class="line">    layout-&gt;<span class="built_in">addWidget</span>(PbGet,<span class="number">3</span>,<span class="number">1</span>);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">setFixedSize</span>(<span class="number">300</span>,<span class="number">200</span>);<span class="comment">//固定大小</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">//按钮点击事件信号槽的连接</span></span><br><span class="line">    <span class="built_in">connect</span>(PbPut,<span class="built_in">SIGNAL</span>(<span class="built_in">clicked</span>()),<span class="keyword">this</span>,<span class="built_in">SLOT</span>(<span class="built_in">slotPut</span>()));</span><br><span class="line">    <span class="built_in">connect</span>(PbGet,<span class="built_in">SIGNAL</span>(<span class="built_in">clicked</span>()),<span class="keyword">this</span>,<span class="built_in">SLOT</span>(<span class="built_in">slotGet</span>()));</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">Dialog::managePut</span><span class="params">(QNetworkReply * reply)</span></span>&#123;</span><br><span class="line">    <span class="built_in">qDebug</span>()&lt;&lt;reply-&gt;<span class="built_in">error</span>();<span class="comment">//输出调试信息</span></span><br><span class="line">    <span class="keyword">switch</span>(reply-&gt;<span class="built_in">error</span>())&#123;<span class="comment">//判断连接后的状态</span></span><br><span class="line">    <span class="keyword">case</span> QNetworkReply::NoError:</span><br><span class="line">        QMessageBox::<span class="built_in">information</span>(<span class="keyword">this</span>,<span class="string">&quot;Put information&quot;</span>,<span class="string">&quot;Upload Success!&quot;</span>);</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> QNetworkReply::HostNotFoundError:</span><br><span class="line">        QMessageBox::<span class="built_in">information</span>(<span class="keyword">this</span>,<span class="string">&quot;Put information&quot;</span>,<span class="string">&quot;Host Not Found!&quot;</span>);</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> QNetworkReply::AuthenticationRequiredError:</span><br><span class="line">        QMessageBox::<span class="built_in">information</span>(<span class="keyword">this</span>,<span class="string">&quot;Put information&quot;</span>,<span class="string">&quot;Login Failure!&quot;</span>);</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">default</span>:</span><br><span class="line">        QMessageBox::<span class="built_in">information</span>(<span class="keyword">this</span>,<span class="string">&quot;Put information&quot;</span>,<span class="string">&quot;Unknown Failure&quot;</span>);</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">Dialog::manageGet</span><span class="params">(QNetworkReply *reply)</span></span>&#123;</span><br><span class="line">    <span class="comment">//基本和managerPut类似   </span></span><br><span class="line">    <span class="built_in">qDebug</span>()&lt;&lt;reply-&gt;<span class="built_in">error</span>();</span><br><span class="line">    QByteArray data;</span><br><span class="line">    <span class="keyword">switch</span>(reply-&gt;<span class="built_in">error</span>())&#123;</span><br><span class="line">    <span class="keyword">case</span> QNetworkReply::NoError:</span><br><span class="line">        data=reply-&gt;<span class="built_in">readAll</span>();<span class="comment">//从url中读取文件内容，输出到data中（也可以再将数据写入到文件中，为了方便，这里就权且打印一下吧）</span></span><br><span class="line">        QMessageBox::<span class="built_in">information</span>(<span class="keyword">this</span>,<span class="string">&quot;Put information&quot;</span>,<span class="string">&quot;Upload Success!nThe file you&#x27;ve got is :n&quot;</span>+data);</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> QNetworkReply::HostNotFoundError:</span><br><span class="line">        QMessageBox::<span class="built_in">information</span>(<span class="keyword">this</span>,<span class="string">&quot;Put information&quot;</span>,<span class="string">&quot;Host Not Found!&quot;</span>);</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> QNetworkReply::AuthenticationRequiredError:</span><br><span class="line">        QMessageBox::<span class="built_in">information</span>(<span class="keyword">this</span>,<span class="string">&quot;Put information&quot;</span>,<span class="string">&quot;Login Failure!&quot;</span>);</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">default</span>:</span><br><span class="line">        QMessageBox::<span class="built_in">information</span>(<span class="keyword">this</span>,<span class="string">&quot;Put information&quot;</span>,<span class="string">&quot;Unknown Failure&quot;</span>);</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Dialog::~<span class="built_in">Dialog</span>()</span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">Dialog::slotPut</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="comment">//判断信息输入完整</span></span><br><span class="line">    <span class="keyword">if</span>(LeUser-&gt;<span class="built_in">text</span>().<span class="built_in">isEmpty</span>()||LePasswd-&gt;<span class="built_in">text</span>().<span class="built_in">isEmpty</span>()||LeServer-&gt;<span class="built_in">text</span>().<span class="built_in">isEmpty</span>())&#123;</span><br><span class="line">        QMessageBox::<span class="built_in">warning</span>(<span class="keyword">this</span>,<span class="string">&quot;Error&quot;</span>,<span class="string">&quot;Please fill in the information&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> ;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//重点！将之前的槽清空并重新连接至需要的</span></span><br><span class="line">    manager.<span class="built_in">disconnect</span>(<span class="built_in">SIGNAL</span>(<span class="built_in">finished</span>(QNetworkReply*)));</span><br><span class="line">    <span class="comment">//完全清空某对象连接的槽可以用manager.disconnect();</span></span><br><span class="line">    <span class="built_in">connect</span>(&amp;manager,<span class="built_in">SIGNAL</span>(<span class="built_in">finished</span>(QNetworkReply*)),<span class="built_in">SLOT</span>(<span class="built_in">managePut</span>(QNetworkReply*)));</span><br><span class="line"></span><br><span class="line">    <span class="comment">//设置登录信息</span></span><br><span class="line">    <span class="function">QUrl <span class="title">url</span><span class="params">(LeServer-&gt;text())</span></span>;</span><br><span class="line">    url.<span class="built_in">setPort</span>(<span class="number">21</span>);</span><br><span class="line">    url.<span class="built_in">setUserName</span>(LeUser-&gt;<span class="built_in">text</span>());</span><br><span class="line">    url.<span class="built_in">setPassword</span>(LePasswd-&gt;<span class="built_in">text</span>());</span><br><span class="line"></span><br><span class="line">    QByteArray data=<span class="string">&quot;This is the test data.n&quot;</span>;</span><br><span class="line">    <span class="comment">/*QNetworkReply *reply=*/</span></span><br><span class="line">    manager.<span class="built_in">put</span>(<span class="built_in">QNetworkRequest</span>(url),data);<span class="comment">//将data上传到url中，返回的reply将触发网络的连接信号</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">Dialog::slotGet</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="comment">//基本意义与slotPut类似</span></span><br><span class="line">    <span class="keyword">if</span>(LeUser-&gt;<span class="built_in">text</span>().<span class="built_in">isEmpty</span>()||LePasswd-&gt;<span class="built_in">text</span>().<span class="built_in">isEmpty</span>()||LeServer-&gt;<span class="built_in">text</span>().<span class="built_in">isEmpty</span>())&#123;</span><br><span class="line">        QMessageBox::<span class="built_in">warning</span>(<span class="keyword">this</span>,<span class="string">&quot;Error&quot;</span>,<span class="string">&quot;Please fill in the information&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> ;</span><br><span class="line">    &#125;</span><br><span class="line">    manager.<span class="built_in">disconnect</span>(<span class="built_in">SIGNAL</span>(<span class="built_in">finished</span>(QNetworkReply*)));</span><br><span class="line">    <span class="built_in">connect</span>(&amp;manager,<span class="built_in">SIGNAL</span>(<span class="built_in">finished</span>(QNetworkReply*)),<span class="built_in">SLOT</span>(<span class="built_in">manageGet</span>(QNetworkReply*)));</span><br><span class="line">    <span class="function">QUrl <span class="title">url</span><span class="params">(LeServer-&gt;text())</span></span>;</span><br><span class="line">    url.<span class="built_in">setPort</span>(<span class="number">21</span>);</span><br><span class="line">    url.<span class="built_in">setUserName</span>(LeUser-&gt;<span class="built_in">text</span>());</span><br><span class="line">    url.<span class="built_in">setPassword</span>(LePasswd-&gt;<span class="built_in">text</span>());</span><br><span class="line">    <span class="comment">/*QNetworkReply *reply=*/</span></span><br><span class="line">    manager.<span class="built_in">get</span>((<span class="built_in">QNetworkRequest</span>(url)));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="main-cpp"><a href="#main-cpp" class="headerlink" title="main.cpp"></a>main.cpp</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;dialog.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;QApplication&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">char</span> *argv[])</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="function">QApplication <span class="title">a</span><span class="params">(argc, argv)</span></span>;</span><br><span class="line">    Dialog w;</span><br><span class="line">    w.<span class="built_in">show</span>();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> a.<span class="built_in">exec</span>();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>5、运行截图</p>
<p>权且只显示主界面：</p>
<p><img src="/images/2015/10/29/1/1.png"></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/52/"><i class="fa fa-angle-left"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/52/">52</a><span class="page-number current">53</span><a class="page-number" href="/page/54/">54</a><span class="space">&hellip;</span><a class="page-number" href="/page/57/">57</a><a class="extend next" rel="next" href="/page/54/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name"></p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/%7C%7C%20archive">
              
                  <span class="site-state-item-count">566</span>
                  <span class="site-state-item-name">posts</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/categories/index.html">
                  <span class="site-state-item-count">67</span>
                  <span class="site-state-item-name">categories</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">278</span>
                  <span class="site-state-item-name">tags</span>
                </a>
              </div>
            

          </nav>

          

          

          
          

          
          

          

        </div>
      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2024</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Companyd</span>

  
</div>


  <div class="powered-by">Powered by <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a></div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">Theme &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Muse</a> v5.1.4</div>




        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  

  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  












  

  <script type="text/javascript">
    // Popup Window;
    var isfetched = false;
    var isXml = true;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length === 0) {
      search_path = "search.xml";
    } else if (/json$/i.test(search_path)) {
      isXml = false;
    }
    var path = "/" + search_path;
    // monitor main search box;

    var onPopupClose = function (e) {
      $('.popup').hide();
      $('#local-search-input').val('');
      $('.search-result-list').remove();
      $('#no-result').remove();
      $(".local-search-pop-overlay").remove();
      $('body').css('overflow', '');
    }

    function proceedsearch() {
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay"></div>')
        .css('overflow', 'hidden');
      $('.search-popup-overlay').click(onPopupClose);
      $('.popup').toggle();
      var $localSearchInput = $('#local-search-input');
      $localSearchInput.attr("autocapitalize", "none");
      $localSearchInput.attr("autocorrect", "off");
      $localSearchInput.focus();
    }

    // search function;
    var searchFunc = function(path, search_id, content_id) {
      'use strict';

      // start loading animation
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay">' +
          '<div id="search-loading-icon">' +
          '<i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>' +
          '</div>' +
          '</div>')
        .css('overflow', 'hidden');
      $("#search-loading-icon").css('margin', '20% auto 0 auto').css('text-align', 'center');

      $.ajax({
        url: path,
        dataType: isXml ? "xml" : "json",
        async: true,
        success: function(res) {
          // get the contents from search data
          isfetched = true;
          $('.popup').detach().appendTo('.header-inner');
          var datas = isXml ? $("entry", res).map(function() {
            return {
              title: $("title", this).text(),
              content: $("content",this).text(),
              url: $("url" , this).text()
            };
          }).get() : res;
          var input = document.getElementById(search_id);
          var resultContent = document.getElementById(content_id);
          var inputEventFunction = function() {
            var searchText = input.value.trim().toLowerCase();
            var keywords = searchText.split(/[\s\-]+/);
            if (keywords.length > 1) {
              keywords.push(searchText);
            }
            var resultItems = [];
            if (searchText.length > 0) {
              // perform local searching
              datas.forEach(function(data) {
                var isMatch = false;
                var hitCount = 0;
                var searchTextCount = 0;
                var title = data.title.trim();
                var titleInLowerCase = title.toLowerCase();
                var content = data.content.trim().replace(/<[^>]+>/g,"");
                var contentInLowerCase = content.toLowerCase();
                var articleUrl = decodeURIComponent(data.url);
                var indexOfTitle = [];
                var indexOfContent = [];
                // only match articles with not empty titles
                if(title != '') {
                  keywords.forEach(function(keyword) {
                    function getIndexByWord(word, text, caseSensitive) {
                      var wordLen = word.length;
                      if (wordLen === 0) {
                        return [];
                      }
                      var startPosition = 0, position = [], index = [];
                      if (!caseSensitive) {
                        text = text.toLowerCase();
                        word = word.toLowerCase();
                      }
                      while ((position = text.indexOf(word, startPosition)) > -1) {
                        index.push({position: position, word: word});
                        startPosition = position + wordLen;
                      }
                      return index;
                    }

                    indexOfTitle = indexOfTitle.concat(getIndexByWord(keyword, titleInLowerCase, false));
                    indexOfContent = indexOfContent.concat(getIndexByWord(keyword, contentInLowerCase, false));
                  });
                  if (indexOfTitle.length > 0 || indexOfContent.length > 0) {
                    isMatch = true;
                    hitCount = indexOfTitle.length + indexOfContent.length;
                  }
                }

                // show search results

                if (isMatch) {
                  // sort index by position of keyword

                  [indexOfTitle, indexOfContent].forEach(function (index) {
                    index.sort(function (itemLeft, itemRight) {
                      if (itemRight.position !== itemLeft.position) {
                        return itemRight.position - itemLeft.position;
                      } else {
                        return itemLeft.word.length - itemRight.word.length;
                      }
                    });
                  });

                  // merge hits into slices

                  function mergeIntoSlice(text, start, end, index) {
                    var item = index[index.length - 1];
                    var position = item.position;
                    var word = item.word;
                    var hits = [];
                    var searchTextCountInSlice = 0;
                    while (position + word.length <= end && index.length != 0) {
                      if (word === searchText) {
                        searchTextCountInSlice++;
                      }
                      hits.push({position: position, length: word.length});
                      var wordEnd = position + word.length;

                      // move to next position of hit

                      index.pop();
                      while (index.length != 0) {
                        item = index[index.length - 1];
                        position = item.position;
                        word = item.word;
                        if (wordEnd > position) {
                          index.pop();
                        } else {
                          break;
                        }
                      }
                    }
                    searchTextCount += searchTextCountInSlice;
                    return {
                      hits: hits,
                      start: start,
                      end: end,
                      searchTextCount: searchTextCountInSlice
                    };
                  }

                  var slicesOfTitle = [];
                  if (indexOfTitle.length != 0) {
                    slicesOfTitle.push(mergeIntoSlice(title, 0, title.length, indexOfTitle));
                  }

                  var slicesOfContent = [];
                  while (indexOfContent.length != 0) {
                    var item = indexOfContent[indexOfContent.length - 1];
                    var position = item.position;
                    var word = item.word;
                    // cut out 100 characters
                    var start = position - 20;
                    var end = position + 80;
                    if(start < 0){
                      start = 0;
                    }
                    if (end < position + word.length) {
                      end = position + word.length;
                    }
                    if(end > content.length){
                      end = content.length;
                    }
                    slicesOfContent.push(mergeIntoSlice(content, start, end, indexOfContent));
                  }

                  // sort slices in content by search text's count and hits' count

                  slicesOfContent.sort(function (sliceLeft, sliceRight) {
                    if (sliceLeft.searchTextCount !== sliceRight.searchTextCount) {
                      return sliceRight.searchTextCount - sliceLeft.searchTextCount;
                    } else if (sliceLeft.hits.length !== sliceRight.hits.length) {
                      return sliceRight.hits.length - sliceLeft.hits.length;
                    } else {
                      return sliceLeft.start - sliceRight.start;
                    }
                  });

                  // select top N slices in content

                  var upperBound = parseInt('1');
                  if (upperBound >= 0) {
                    slicesOfContent = slicesOfContent.slice(0, upperBound);
                  }

                  // highlight title and content

                  function highlightKeyword(text, slice) {
                    var result = '';
                    var prevEnd = slice.start;
                    slice.hits.forEach(function (hit) {
                      result += text.substring(prevEnd, hit.position);
                      var end = hit.position + hit.length;
                      result += '<b class="search-keyword">' + text.substring(hit.position, end) + '</b>';
                      prevEnd = end;
                    });
                    result += text.substring(prevEnd, slice.end);
                    return result;
                  }

                  var resultItem = '';

                  if (slicesOfTitle.length != 0) {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + highlightKeyword(title, slicesOfTitle[0]) + "</a>";
                  } else {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + title + "</a>";
                  }

                  slicesOfContent.forEach(function (slice) {
                    resultItem += "<a href='" + articleUrl + "'>" +
                      "<p class=\"search-result\">" + highlightKeyword(content, slice) +
                      "...</p>" + "</a>";
                  });

                  resultItem += "</li>";
                  resultItems.push({
                    item: resultItem,
                    searchTextCount: searchTextCount,
                    hitCount: hitCount,
                    id: resultItems.length
                  });
                }
              })
            };
            if (keywords.length === 1 && keywords[0] === "") {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-search fa-5x" /></div>'
            } else if (resultItems.length === 0) {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>'
            } else {
              resultItems.sort(function (resultLeft, resultRight) {
                if (resultLeft.searchTextCount !== resultRight.searchTextCount) {
                  return resultRight.searchTextCount - resultLeft.searchTextCount;
                } else if (resultLeft.hitCount !== resultRight.hitCount) {
                  return resultRight.hitCount - resultLeft.hitCount;
                } else {
                  return resultRight.id - resultLeft.id;
                }
              });
              var searchResultList = '<ul class=\"search-result-list\">';
              resultItems.forEach(function (result) {
                searchResultList += result.item;
              })
              searchResultList += "</ul>";
              resultContent.innerHTML = searchResultList;
            }
          }

          if ('auto' === 'auto') {
            input.addEventListener('input', inputEventFunction);
          } else {
            $('.search-icon').click(inputEventFunction);
            input.addEventListener('keypress', function (event) {
              if (event.keyCode === 13) {
                inputEventFunction();
              }
            });
          }

          // remove loading animation
          $(".local-search-pop-overlay").remove();
          $('body').css('overflow', '');

          proceedsearch();
        }
      });
    }

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched === false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };
    });

    $('.popup-btn-close').click(onPopupClose);
    $('.popup').click(function(e){
      e.stopPropagation();
    });
    $(document).on('keyup', function (event) {
      var shouldDismissSearchPopup = event.which === 27 &&
        $('.search-popup').is(':visible');
      if (shouldDismissSearchPopup) {
        onPopupClose();
      }
    });
  </script>





  

  

  

  
  

  

  

  

</body>
</html>
